# üõ£Ô∏è Route Risk Assessment

–û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–∞ –¥–æ—Ä–æ–∂–Ω–æ-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö –ø—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏–π (–î–¢–ü) –¥–ª—è –∫–∞—Ä—à–µ—Ä–∏–Ω–≥–æ–≤—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤.

## üìå –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –î–¢–ü –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–º –º–∞—Ä—à—Ä—É—Ç–µ **–¥–æ –Ω–∞—á–∞–ª–∞ –ø–æ–µ–∑–¥–∫–∏**. –ú–æ–¥–µ–ª—å –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è—Ö, –≤–æ–¥–∏—Ç–µ–ª—è—Ö, –ø–æ–≥–æ–¥–µ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞, —á—Ç–æ–±—ã:

* –ü–æ–≤—ã—Å–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤.
* –°–Ω–∏–∑–∏—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ—Ç–µ—Ä–∏ –∫–æ–º–ø–∞–Ω–∏–∏.
* –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–º —Ä–∏—Å–∫–µ.

---

## üß† –ö–ª—é—á–µ–≤—ã–µ –∑–∞–¥–∞—á–∏

* –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤–∏–Ω–æ–≤–Ω–æ—Å—Ç–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –î–¢–ü (`at_fault`).
* –ê–Ω–∞–ª–∏–∑ —Ñ–∞–∫—Ç–æ—Ä–æ–≤, –≤–ª–∏—è—é—â–∏—Ö –Ω–∞ –∞–≤–∞—Ä–∏–π–Ω–æ—Å—Ç—å.
* –û—Ü–µ–Ω–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (–∫–∞–º–µ—Ä—ã, –∞–ª–∫–æ—Ç–µ—Å—Ç–µ—Ä—ã –∏ –¥—Ä.).
* –û—Ç–≤–µ—Ç –Ω–∞ –±–∏–∑–Ω–µ—Å-–≤–æ–ø—Ä–æ—Å: **–º–æ–∂–Ω–æ –ª–∏ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å —Ä–∏—Å–∫ –º–∞—Ä—à—Ä—É—Ç–∞ —Å –ø—Ä–∏–µ–º–ª–µ–º–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é?**

---

## üóÉÔ∏è –î–∞–Ω–Ω—ã–µ

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏:**

* `collisions` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –î–¢–ü (–¥–∞—Ç–∞, –≤—Ä–µ–º—è, –º–µ—Å—Ç–æ, –ø–æ–≥–æ–¥–∞, –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è).
* `parties` ‚Äî —É—á–∞—Å—Ç–Ω–∏–∫–∏ –î–¢–ü (—Ç–∏–ø, —Ç—Ä–µ–∑–≤–æ—Å—Ç—å, —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ, –≤–∏–Ω–æ–≤–Ω–æ—Å—Ç—å).
* `vehicles` ‚Äî —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ (–≤–æ–∑—Ä–∞—Å—Ç, —Ç–∏–ø, —Ç–µ—Ö. —Å–æ—Å—Ç–æ—è–Ω–∏–µ).

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**

* –¢–∏–ø —É—á–∞—Å—Ç–Ω–∏–∫–∞: —Ç–æ–ª—å–∫–æ `car`.
* –¢–∏–ø –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π: –∏—Å–∫–ª—é—á–µ–Ω—ã `SCRATCH`.
* –ü–µ—Ä–∏–æ–¥: —Ç–æ–ª—å–∫–æ **2012 –≥–æ–¥**.

**–ò–∑–≤–ª–µ—á—ë–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:**

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è     | –ü—Ä–∏–∑–Ω–∞–∫–∏                                       |
| ------------- | ---------------------------------------------- |
| –í—Ä–µ–º—è         | –î–∞—Ç–∞, –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏, —á–∞—Å—ã –ø–∏–∫                    |
| –ü–æ–≥–æ–¥–∞/–¥–æ—Ä–æ–≥–∏ | –°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–æ—Ä–æ–≥–∏, –ø–æ–≥–æ–¥–∞, –æ—Å–≤–µ—â–µ–Ω–∏–µ            |
| –í–æ–¥–∏—Ç–µ–ª—å      | –¢—Ä–µ–∑–≤–æ—Å—Ç—å, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞, —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ |
| –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç     | –í–æ–∑—Ä–∞—Å—Ç, —Ç–∏–ø, —Ç–µ—Ö. —Å–æ—Å—Ç–æ—è–Ω–∏–µ                   |
| –¶–µ–ª—å          | `at_fault` ‚Äî –≤–∏–Ω–æ–≤–Ω–æ—Å—Ç—å                        |

---

## üîç –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è

### üì• –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

* –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL –±–∞–∑–µ (—á–µ—Ä–µ–∑ `sqlalchemy`).
* –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø—É, –¥–∞—Ç–µ –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä—É –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π.
* –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –ø–æ `case_id`, `party_number`.
* –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤: –±–∏–Ω–∞—Ä–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã, –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è, —Ä–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏.

### üìä –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö (EDA)

* `seaborn`, `matplotlib` ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π.
* –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ `phik` (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ).
* –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑: —Å–≤—è–∑—å –ø–æ–≥–æ–¥–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π, –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫ –∏ –≤–∏–Ω—ã.

### ü§ñ –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

| –ú–æ–¥–µ–ª—å                               | –ü–æ–¥—Ö–æ–¥                            |
| ------------------------------------ | --------------------------------- |
| `CatBoostClassifier`                 | –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç                  |
| `LightGBM`, `RandomForest`, `LogReg` | –í —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏                       |
| `GridSearchCV`                       | –ü–æ–∏—Å–∫ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤             |
| –ú–µ—Ç—Ä–∏–∫–∞: `ROC-AUC`                   | –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –¥–∏—Å–±–∞–ª–∞–Ω—Å—É –∫–ª–∞—Å—Å–æ–≤ |

### üßæ –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è

* SHAP ‚Äî –æ—Ü–µ–Ω–∫–∞ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.
* ROC-–∫—Ä–∏–≤—ã–µ, –º–∞—Ç—Ä–∏—Ü—ã –æ—à–∏–±–æ–∫, precision/recall –∞–Ω–∞–ª–∏–∑.

---

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

* **–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å**: `CatBoostClassifier`
* **ROC-AUC**: \~0.75‚Äì0.80
* **–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏**:

  * `party_sobriety` ‚Äî —Ç—Ä–µ–∑–≤–æ—Å—Ç—å –≤–æ–¥–∏—Ç–µ–ª—è
  * `vehicle_age` ‚Äî –≤–æ–∑—Ä–∞—Å—Ç –º–∞—à–∏–Ω—ã
  * `collision_time` ‚Äî –≤—Ä–µ–º—è –∞–≤–∞—Ä–∏–∏
  * `weather_1` ‚Äî –ø–æ–≥–æ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è

---

## üß© –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

* **–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ**: —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞–º–µ—Ä –∏ –∞–ª–∫–æ—Ç–µ—Å—Ç–µ—Ä–æ–≤.
* **–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö**: –º–∞—Ä—à—Ä—É—Ç—ã, –ø–µ—Ä–µ–∫—Ä—ë—Å—Ç–∫–∏, —Ç—Ä–∞—Ñ–∏–∫.
* **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –Ω–∞ —ç—Ç–∞–ø–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.

---

## üß™ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone https://github.com/Radigos-X/Route_Risk_Assessment.git
cd Route_Risk_Assessment
pip install -r requirements.txt
```

---

## üìñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### üìå –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ

```python
db_config = {
    'user': 'praktikum_student',
    'pwd': 'Sdf4$2;d-d30pp',
    'host': 'rc1b-wcoijxj3yxfsf3fs.mdb.yandexcloud.net',
    'port': 6432,
    'db': 'data-science-vehicle-db'
}
```

### üìä –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –æ–±—É—á–µ–Ω–∏–µ

–í—ã–ø–æ–ª–Ω–∏—Ç–µ —è—á–µ–π–∫–∏ –≤ `Route_Risk_Assessment.ipynb`:

* –ó–∞–≥—Ä—É–∑–∫–∞ SQL-–¥–∞–Ω–Ω—ã—Ö.
* –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü.
* –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π.
* –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

### üìà –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ

```python
predictions = model.predict_proba(new_data)[:, 1]
```

---

## üß∞ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —á–µ—Ä–µ–∑ `pip install -r requirements.txt`:

```text
pandas
numpy
sqlalchemy
scikit-learn
catboost
lightgbm
xgboost
phik
seaborn
matplotlib
tqdm
tqdm_joblib
```

---

## üì¨ –ö–æ–Ω—Ç–∞–∫—Ç—ã

* **Email**: [i@outis-x.ru](mailto:i@outis-x.ru)
* **GitHub**: [Radigos-X](https://github.com/Radigos-X)